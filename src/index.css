@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom animations */
@layer utilities {
  @keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }
  .animate-shimmer {
    background-image: linear-gradient(
      90deg,
      rgba(255,255,255,0) 0%,
      rgba(255,255,255,0.6) 50%,
      rgba(255,255,255,0) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.6s linear infinite;
  }
}

/* Subtle page background gradient (light + dark) */
@layer base {
  body {
    /* Lighter, scroll-attached background to avoid repaint on scroll */
    background:
      radial-gradient(1000px 720px at 12% 0%, rgba(var(--ocean-glow),0.14), transparent 55%),
      radial-gradient(900px 620px at 88% 100%, rgba(var(--v-turquoise),0.10), transparent 60%),
      linear-gradient(180deg, #f6f9fe 0%, #eef2f9 100%);
    background-attachment: scroll, scroll, scroll;
  }
  html, body, .neo-card, .neo-pressed, .progress-track, .ocean-bg {
    transition: background-color .25s ease, color .25s ease, border-color .25s ease, box-shadow .25s ease;
  }
  .dark body {
    background:
      radial-gradient(1100px 760px at 15% 5%, rgba(56,189,248,0.18), transparent 60%),
      radial-gradient(900px 640px at 85% 95%, rgba(45,212,191,0.14), transparent 60%),
      linear-gradient(180deg, #0a111d 0%, #080e18 100%);
    background-attachment: scroll, scroll, scroll;
  }
}

/* Atlas color tokens - Rethemed to Dark Blue / Blue palette */
:root {
  /* Core neutrals */
  --v-offblack: 17 24 39;        /* #111827 */
  --v-paper: 252 252 252;        /* #FCFCFC */

  /* Brand blues */
  --brand-primary-rgb: 30 58 138;    /* #1E3A8A blue-800 */
  --brand-accent-rgb: 37 99 235;     /* #2563EB blue-600 */
  --brand-accent2-rgb: 14 165 233;   /* #0EA5E9 sky-500 */

  /* Legacy ocean variables remapped to blue palette for compatibility */
  --ocean-deep: 11 18 32;        /* #0B1220 */
  --ocean-teal: 23 37 84;        /* #172554 indigo-950-ish */
  --ocean-glow: 59 130 246;      /* #3B82F6 blue-500 */

  /* Back-compat: map v-turquoise to brand accent */
  --v-turquoise: var(--brand-accent-rgb);

  /* Legacy brand tokens retained for compatibility */
  --brand-blue: var(--brand-accent-rgb);
  --brand-coral: var(--brand-accent2-rgb);
  --brand-butter: 239 246 255;   /* blue-50 */
  --brand-lavender: 219 234 254; /* blue-100 */
  --brand-cream: var(--v-paper);
}

.dark {
  --v-offblack: 241 245 249;     /* #F1F5F9 for text on dark */
  --v-paper: 10 15 25;           /* deep near-black */

  /* Slightly brighter blues in dark */
  --brand-primary-rgb: 30 64 175;  /* #1D4ED8 blue-700 */
  --brand-accent-rgb: 59 130 246;  /* #3B82F6 blue-500 */
  --brand-accent2-rgb: 56 189 248; /* #38BDF8 sky-400 */

  --brand-blue: var(--brand-accent-rgb);
  --brand-coral: var(--brand-accent2-rgb);
  --brand-butter: 8 47 73;        /* slate/blue deep tint */
  --brand-lavender: 30 58 138;    /* blue-800 */
  --brand-cream: var(--v-paper);

  /* Back-compat for dark mode */
  --v-turquoise: var(--brand-accent-rgb);
}

/* Neumorphism helpers */
@layer components {
  /* Atlas Spinner */
  @keyframes spin360 {
    to { transform: rotate(360deg); }
  }
  .atlas-spinner {
    position: relative;
    display: inline-block;
    width: var(--vs, 3rem);
    height: var(--vs, 3rem);
    border-radius: 9999px;
    /* Turquoise sweep with hollow center */
    background: conic-gradient(
      from 0deg,
      rgba(var(--v-turquoise), 0) 0deg,
      rgba(var(--v-turquoise), 0.15) 90deg,
      rgba(var(--v-turquoise), 0.85) 360deg
    );
    -webkit-mask: radial-gradient(farthest-side, transparent calc(100% - 6px), #000 0);
    mask: radial-gradient(farthest-side, transparent calc(100% - 6px), #000 0);
    animation: spin360 .9s linear infinite;
    will-change: transform;
  }
  .atlas-spinner::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    box-shadow: inset 0 0 0 4px rgba(100,116,139,0.18);
  }

  @media (prefers-reduced-motion: reduce) {
    .atlas-spinner { animation-duration: 1.6s; }
  }

  /* Dark mode overrides for common Tailwind utility colors used across components */
  .dark .text-slate-800 { color: #e5e7eb !important; }
  .dark .text-slate-700 { color: #e5e7eb !important; }
  .dark .text-slate-600 { color: #cbd5e1 !important; }
  .dark .text-slate-500 { color: #94a3b8 !important; }
  .dark .text-slate-400 { color: #8191a7 !important; }
  .dark .bg-white { background-color: rgba(10,15,25,0.92) !important; }
  .dark .border-slate-200 { border-color: rgba(148,163,184,0.24) !important; }
  .dark .border-slate-300 { border-color: rgba(148,163,184,0.28) !important; }
  .dark .bg-slate-50 { background-color: rgba(8,14,24,0.92) !important; }
  .dark .bg-slate-100 { background-color: rgba(255,255,255,0.08) !important; }
  .dark .text-slate-800 a { color: rgb(var(--v-turquoise)); }

  /* Smooth progress (determinate + indeterminate) */
  .progress-track {
    position: relative;
    overflow: hidden;
    height: 0.75rem; /* 12px */
    border-radius: 9999px;
    background: rgba(15,23,42,0.08);
  }
  .dark .progress-track { background: rgba(148,163,184,0.16); }
  .progress-bar {
    height: 100%;
    background: linear-gradient(90deg, rgba(20,184,166,0.35), rgba(20,184,166,0.85));
    transform-origin: left center;
    transform: scaleX(var(--p, 0));
    transition: transform .45s cubic-bezier(0.22, 1, 0.36, 1);
    will-change: transform;
  }
  @keyframes progress-slide {
    0% { transform: translateX(-40%); }
    100% { transform: translateX(140%); }
  }
  .progress-bar-indeterminate {
    position: absolute;
    top: 0; bottom: 0;
    left: -40%;
    width: 40%;
    background: linear-gradient(90deg, rgba(20,184,166,0.25), rgba(20,184,166,0.85));
    border-radius: inherit;
    animation: progress-slide 1.2s ease-in-out infinite;
    will-change: transform;
  }
  @media (prefers-reduced-motion: reduce) {
    .progress-bar-indeterminate { animation-duration: 2.4s; }
  }
  /* Gradient buttons and states (retuned to blue palette) */
  .btn-gradient {
    @apply bg-gradient-to-r from-blue-600 via-indigo-500 to-sky-500 text-white;
  }
  .btn-gradient:hover { filter: brightness(1.06); }
  .btn-gradient:disabled { opacity: 0.6; cursor: not-allowed; }

  .nav-active-gradient {
    @apply bg-gradient-to-r from-blue-600 via-indigo-500 to-sky-500 text-white;
  }

  .bubble-user-gradient {
    @apply bg-gradient-to-r from-blue-600 via-indigo-500 to-sky-500 text-white;
  }
  /* App background (blue ambient gradients) */
  .bg-app {
    background-image:
      radial-gradient(1000px 600px at 10% -10%, rgba(var(--brand-accent-rgb),0.18), rgba(255,255,255,0)),
      radial-gradient(800px 500px at 110% -20%, rgba(var(--brand-accent2-rgb),0.16), rgba(255,255,255,0));
    background-color: rgb(var(--brand-butter));
  }
  .dark .bg-app { background-color: rgb(var(--ocean-deep)); }

  /* Subtle highlights for depth */
  .bg-app::after {
    content: '';
    position: fixed;
    inset: 0;
    pointer-events: none;
    background:
      radial-gradient(600px 400px at 20% 15%, rgba(255,255,255,0.05), transparent 60%),
      radial-gradient(900px 500px at 80% 85%, rgba(255,255,255,0.04), transparent 70%);
    mix-blend-mode: soft-light;
  }
  /* Decorative ocean orbs and arcs */
  .ocean-orb {
    position: fixed;
    width: 420px;
    height: 420px;
    border-radius: 9999px;
    background: radial-gradient(circle at 40% 40%, rgba(var(--ocean-glow),0.55), rgba(255,255,255,0.0) 60%),
                radial-gradient(circle at 60% 60%, rgba(var(--v-turquoise),0.35), rgba(255,255,255,0.0) 70%);
    /* Reduce blur for lower paint cost */
    filter: blur(16px);
    opacity: 0.35;
    pointer-events: none;
    will-change: transform, opacity;
    transform: translateZ(0);
  }
  .ocean-arc {
    position: fixed;
    width: 80vw;
    height: 80vw;
    border-radius: 50%;
    border: 1px solid rgba(255,255,255,0.08);
    pointer-events: none;
    mask-image: radial-gradient(circle, black 40%, transparent 60%);
    opacity: 0.6;
    will-change: transform, opacity;
    transform: translateZ(0);
  }

  /* Ocean progress bar */
  @keyframes ocean-wave {
    0% { background-position: 0 0, 0 0; }
    100% { background-position: 200% 0, 200% 0; }
  }
  .ocean-progress {
    position: relative;
    overflow: hidden;
    border-radius: 9999px;
    background: rgba(15, 23, 42, 0.08);
  }
  .ocean-progress-bar {
    height: 100%;
    background:
      linear-gradient(90deg, rgba(var(--brand-accent-rgb),0.35), rgba(var(--brand-accent-rgb),0.75)),
      repeating-linear-gradient(135deg, rgba(var(--brand-accent2-rgb),0.22) 0 12px, rgba(255,255,255,0.12) 12px 24px);
    background-size: 200% 100%, 200% 100%;
    animation: ocean-wave 2.2s linear infinite;
  }
  .neo-surface {
    background: rgb(var(--v-paper));
    box-shadow: 20px 20px 50px rgba(0, 0, 0, 0.12), -20px -20px 50px rgba(255, 255, 255, 0.85);
  }
  .neo-card {
    background: rgb(var(--v-paper));
    /* Lighter shadows to reduce paint cost */
    box-shadow: 0 10px 20px rgba(7, 21, 33, 0.18), 0 4px 10px rgba(7, 21, 33, 0.12);
    /* Avoid backdrop-filter on scrollable surfaces (expensive) */
  }
  .neo-pressed {
    background: rgb(var(--v-paper));
    box-shadow: inset 8px 8px 18px rgba(7, 21, 33, 0.10), inset -8px -8px 18px rgba(255, 255, 255, 0.85);
  }

  .dark .neo-surface {
    background: rgba(10, 15, 25, 0.95);
    box-shadow: 20px 20px 50px rgba(0, 0, 0, 0.60), -20px -20px 50px rgba(255, 255, 255, 0.06);
  }
  .dark .neo-card {
    background: rgba(10, 15, 25, 0.92);
    box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.45), -8px -8px 20px rgba(255, 255, 255, 0.04);
  }
  .dark .neo-pressed {
    background: rgba(10, 15, 25, 0.92);
    box-shadow: inset 6px 6px 12px rgba(0, 0, 0, 0.6), inset -6px -6px 12px rgba(255, 255, 255, 0.06);
  }

  /* Subtle divider */
  .neo-divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.08), transparent);
  }
  .dark .neo-divider {
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.08), transparent);
  }

  /* Pretty scrollbar for panel */
  .pretty-scrollbar::-webkit-scrollbar {
    width: 10px;
  }
  .pretty-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }
  .pretty-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(100, 116, 139, 0.4);
    border-radius: 9999px;
  }
  .dark .pretty-scrollbar::-webkit-scrollbar-thumb {
    background: rgba(148, 163, 184, 0.35);
  }
}

/* Utilities */
@layer utilities {
  .gpu-layer {
    will-change: transform;
    transform: translateZ(0);
  }
  .cv-auto {
    content-visibility: auto;
    contain-intrinsic-size: 1px 600px;
  }
  .will-change-transform-opacity {
    will-change: transform, opacity;
  }
  /* New primitives from design template */
  .card {
    @apply rounded-2xl border p-5 shadow-lg;
    background-color: rgba(255,255,255,0.7);
    backdrop-filter: blur(12px);
    border-color: rgba(229,231,235,1); /* gray-200 */
  }
  .dark .card {
    background-color: rgba(255,255,255,0.05);
    border-color: rgba(255,255,255,0.10);
  }

  .btn {
    @apply inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium shadow-lg transition-all;
  }
  .btn-primary {
    background-image: linear-gradient(135deg, rgb(var(--brand-accent-rgb)), rgb(var(--brand-accent2-rgb)));
    color: white;
  }
  .btn-primary:hover { transform: translateY(-1px); filter: brightness(1.05); }
  .btn-secondary {
    background-color: rgba(255,255,255,0.7);
    color: #111827;
    border: 1px solid #e5e7eb;
  }
  .dark .btn-secondary {
    background-color: rgba(255,255,255,0.10);
    color: #e5e7eb;
    border-color: rgba(255,255,255,0.10);
  }

  .input, .textarea {
    @apply w-full rounded-xl border px-3 py-2 text-sm shadow-lg focus:outline-none;
    background-color: rgba(255,255,255,0.8);
    border-color: #e5e7eb;
  }
  .textarea { @apply resize-none; }
  .input:focus, .textarea:focus {
    outline: none;
    box-shadow: 0 0 0 2px rgba(var(--brand-accent-rgb), 0.5);
    border-color: rgba(var(--brand-accent-rgb), 0.6);
  }
  .dark .input, .dark .textarea {
    background-color: rgba(255,255,255,0.05);
    border-color: rgba(255,255,255,0.10);
    color: #e5e7eb;
  }

  .pill-toggle {
    @apply inline-flex items-center rounded-full border p-1;
    background-color: rgba(255,255,255,0.7);
  }
  .pill-toggle button { @apply rounded-full px-3 py-1 text-xs; }
  .pill-toggle button.active {
    background-color: rgb(var(--brand-accent-rgb));
    color: white;
    box-shadow: 0 10px 25px rgba(37,99,235,0.35);
  }

  /* Hover glow effect */
  .card, .btn, .input, .textarea, .pill-toggle { position: relative; z-index: 0; }
  .card::before, .btn::before, .input::before, .textarea::before, .pill-toggle::before {
    content: '';
    position: absolute; inset: -4px; border-radius: inherit; pointer-events: none; opacity: 0;
    transition: opacity 200ms ease;
    background: radial-gradient(240px 240px at var(--glow-x,50%) var(--glow-y,50%), rgba(var(--brand-accent-rgb),0.25), rgba(var(--brand-accent2-rgb),0.15), transparent 60%);
    filter: blur(28px); z-index: -1;
  }
  .card:hover::before, .btn:hover::before, .input:focus::before, .textarea:focus::before, .pill-toggle:hover::before { opacity: 1; }
}

/* Ray UI (from-scratch alternative theme) */
@layer utilities {
  /* Default (light) */
  .ray-bg { background: radial-gradient(1200px 800px at 80% -10%, rgba(14,165,233,0.10), transparent 60%), radial-gradient(900px 600px at -10% 20%, rgba(37,99,235,0.10), transparent 60%), linear-gradient(180deg, #f8fafc 0%, #eef2f7 100%); }
  /* Dark */
  .dark .ray-bg { background: radial-gradient(1200px 800px at 80% -10%, rgba(255,0,128,0.06), transparent 60%), radial-gradient(900px 600px at -10% 20%, rgba(59,130,246,0.08), transparent 60%), linear-gradient(180deg, #0b0f14 0%, #0a0d12 100%); }
  .ray-card {
    position: relative;
    border-radius: 22px;
    background: rgba(22, 26, 32, 0.7);
    border: 1px solid rgba(255,255,255,0.06);
    box-shadow: 0 10px 30px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.06);
    backdrop-filter: blur(16px);
  }
  .ray-window { border-radius: 24px; background: rgba(255,255,255,0.8); border: 1px solid rgba(0,0,0,0.06); box-shadow: 0 40px 120px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.9); backdrop-filter: blur(12px); }
  .dark .ray-window { background: rgba(15,18,23,0.75); border: 1px solid rgba(255,255,255,0.08); box-shadow: 0 40px 120px rgba(0,0,0,0.65), inset 0 1px 0 rgba(255,255,255,0.08); backdrop-filter: blur(20px); }
  .ray-btn { @apply inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium; color: #0f172a; background: rgba(255,255,255,0.8); border: 1px solid rgba(0,0,0,0.06); box-shadow: 0 6px 18px rgba(15,23,42,0.08), inset 0 1px 0 rgba(255,255,255,0.9); backdrop-filter: blur(10px); }
  .dark .ray-btn { color: #e5e7eb; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.14); box-shadow: 0 6px 18px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.10); }
  .ray-btn:hover { filter: brightness(1.08); }
  .ray-btn-primary { color: white; background: linear-gradient(135deg, #2563eb, #0ea5e9); border: 1px solid rgba(255,255,255,0.2); }
  .ray-seg { @apply inline-flex items-center rounded-full border px-1 py-1; border-color: rgba(0,0,0,0.08); background: rgba(255,255,255,0.8); backdrop-filter: blur(10px); }
  .ray-seg button { @apply rounded-full px-3 py-1 text-sm; color: #475569; }
  .ray-seg button.active { color: #0b0f14; background: white; box-shadow: 0 8px 24px rgba(15,23,42,0.06); }
  .dark .ray-seg { border-color: rgba(255,255,255,0.12); background: rgba(255,255,255,0.04); }
  .dark .ray-seg button { color: #cbd5e1; }
  .dark .ray-seg button.active { color: #0b0f14; background: white; box-shadow: 0 8px 24px rgba(255,255,255,0.12); }
}
/* Special styling for Atlas Assistant nav item */
@layer components {
  @keyframes atlas-shimmer {
    0% { transform: translateX(-160%); }
    100% { transform: translateX(160%); }
  }
  .ray-seg button.atlas-assistant-pill,
  .ray-seg button.atlas-assistant-pill.active {
    color: white;
    background: linear-gradient(135deg, #2563eb 0%, #7c3aed 50%, #0ea5e9 100%);
    border-color: transparent;
    position: relative;
    overflow: hidden;
    box-shadow: 0 10px 28px rgba(14,165,233,0.35), 0 2px 0 rgba(255,255,255,0.25) inset;
  }
  .dark .ray-seg button.atlas-assistant-pill,
  .dark .ray-seg button.atlas-assistant-pill.active {
    box-shadow: 0 12px 36px rgba(37,99,235,0.45), 0 1px 0 rgba(255,255,255,0.08) inset;
  }
  .ray-seg button.atlas-assistant-pill::after {
    content: '';
    position: absolute;
    top: -30%;
    bottom: -30%;
    width: 40%;
    left: -40%;
    background: linear-gradient(100deg, rgba(255,255,255,0) 20%, rgba(255,255,255,0.35) 45%, rgba(255,255,255,0) 70%);
    transform: translateX(-160%) skewX(-12deg);
    animation: atlas-shimmer 3.2s ease-in-out infinite;
    pointer-events: none;
  }
  .ray-seg button.atlas-assistant-pill:hover::after { animation-duration: 1.8s; }
}

/* Ambient UI blobs + cursor glow */
@layer utilities {
  @keyframes blob-float {
    0% { transform: translate3d(0,0,0) scale(1); }
    50% { transform: translate3d(2%, -3%, 0) scale(1.05); }
    100% { transform: translate3d(0,0,0) scale(1); }
  }
  @keyframes blob-float-slow {
    0% { transform: translate3d(0,0,0) scale(1); }
    50% { transform: translate3d(-3%, 2%, 0) scale(1.06); }
    100% { transform: translate3d(0,0,0) scale(1); }
  }
  .ui-blobs { position: fixed; inset: 0; pointer-events: none; z-index: -9; }
  .ui-blob {
    position: absolute;
    border-radius: 9999px;
    filter: blur(60px);
    opacity: 0.35;
    mix-blend-mode: soft-light;
    will-change: transform, opacity;
  }
  .ui-blob--1 { width: 520px; height: 520px; top: -120px; left: -120px; animation: blob-float 14s ease-in-out infinite; }
  .ui-blob--2 { width: 680px; height: 680px; bottom: -160px; right: -160px; animation: blob-float-slow 18s ease-in-out infinite; }
  .ui-blob--3 { width: 420px; height: 420px; bottom: 10%; left: -120px; animation: blob-float 16s ease-in-out infinite; }
  .ui-blob--4 { width: 380px; height: 380px; top: 12%; right: 8%; animation: blob-float-slow 22s ease-in-out infinite; }
  .ui-blob { background: radial-gradient(circle at 40% 40%, rgba(var(--brand-accent-rgb),0.45), rgba(255,255,255,0.0) 60%), radial-gradient(circle at 60% 60%, rgba(var(--brand-accent2-rgb),0.40), rgba(255,255,255,0.0) 70%); }
  .dark .ui-blob { opacity: 0.28; filter: blur(80px); mix-blend-mode: screen; }

  /* Cursor glow following --glow-x / --glow-y variables */
  .cursor-glow {
    position: fixed; inset: 0; pointer-events: none; z-index: -8;
    background: radial-gradient(380px 380px at var(--glow-x,50%) var(--glow-y,50%), rgba(var(--brand-accent-rgb),0.12), rgba(var(--brand-accent2-rgb),0.08), transparent 60%);
    transition: background-position 80ms linear, opacity 200ms ease;
  }
  .dark .cursor-glow { background: radial-gradient(420px 420px at var(--glow-x,50%) var(--glow-y,50%), rgba(var(--brand-accent-rgb),0.18), rgba(var(--brand-accent2-rgb),0.12), transparent 60%); }
  @media (prefers-reduced-motion: reduce) {
    .ui-blob--1, .ui-blob--2, .ui-blob--3, .ui-blob--4 { animation-duration: 40s; }
  }

  /* Extra depth for cards/buttons in dark mode */
  .dark .card { box-shadow: 0 20px 60px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.06); }
  .dark .btn { box-shadow: 0 12px 30px rgba(0,0,0,0.55), inset 0 1px 0 rgba(255,255,255,0.1); }
}

/* Markdown styles for assistant messages */
@layer components {
  .markdown-body p { margin: 0.25rem 0; }
  .markdown-body { overflow-wrap: anywhere; }
  .markdown-body ul, .markdown-body ol { margin: 0.25rem 0; padding-left: 1.25rem; }
  .markdown-body li { margin: 0.125rem 0; }
  .markdown-body table { width: 100%; border-collapse: collapse; }
  .markdown-body th, .markdown-body td { border: 1px solid rgba(15,23,42,0.2); padding: 0.25rem 0.5rem; }
  .dark .markdown-body th, .dark .markdown-body td { border-color: rgba(255,255,255,0.12); }
  .markdown-body thead { background: rgba(15,23,42,0.06); }
  .dark .markdown-body thead { background: rgba(255,255,255,0.06); }
  .markdown-body a { color: #2563eb; text-decoration: underline; }
}
